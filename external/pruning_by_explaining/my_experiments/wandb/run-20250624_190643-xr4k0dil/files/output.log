load the dataset
isic
get train set
[0 1 2]
Number of unique labels: 2, Number of unique places: 2, Total groups: 4
group 0: 6314
group 1: 5526
group 2: 1571
get valid set
[0 1 2 3]
Number of unique labels: 2, Number of unique places: 2, Total groups: 4
group 0: 60
group 1: 60
group 2: 60
group 3: 60
get test set
[0 1 2 3]
Number of unique labels: 2, Number of unique places: 2, Total groups: 4
group 0: 3158
group 1: 2763
group 2: 882
group 3: 761
0
1
2
3
pruning indices  40
0
1
2
3
pruning indices (val) 160
Arch:vit_b_16
pruning_rates
[0, 0.01, 0.05, 0.1, 0.2, 0.3]
/home/primmere/.conda/envs/dfr2/lib/python3.10/site-packages/torch/autograd/graph.py:768: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at ../aten/src/ATen/cuda/CublasHandlePool.cpp:135.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Initial accuracy (val set): top1=0.5625
Initial worst accuracy (val set)=0.2
Initial group accuracies (val set)={0: 0.2, 1: 0.525, 2: 0.8, 3: 0.725}
Computing accuracy for model pruned with 30%:  83%|████████▎ | 5/6 [00:19<00:03,  3.92s/it]
acc top1 (train) 0.575
group accs (train) {1: 0.4, 0: 0.1, 3: 1.0, 2: 0.8}
Accuracy-Flow list (val): [0.5625]
Group accuracy (val): {0: 0.2, 1: 0.525, 2: 0.8, 3: 0.725}
Logged the results of 0% Pruning Rate to wandb!
/home/primmere/logs/pxp/results/4/1.0.pth
acc top1 (train) 0.55
group accs (train) {0: 0.1, 2: 0.7, 3: 1.0, 1: 0.4}
Accuracy-Flow list (val): [0.5625, 0.5625]
Group accuracy (val): {0: 0.2, 1: 0.5, 2: 0.8, 3: 0.75}
Logged the results of 0.01% Pruning Rate to wandb!
/home/primmere/logs/pxp/results/4/5.0.pth
acc top1 (train) 0.55
group accs (train) {1: 0.3, 3: 1.0, 2: 0.8, 0: 0.1}
Accuracy-Flow list (val): [0.5625, 0.5625, 0.54375]
Group accuracy (val): {0: 0.2, 1: 0.45, 2: 0.8, 3: 0.725}
Logged the results of 0.05% Pruning Rate to wandb!
/home/primmere/logs/pxp/results/4/10.0.pth
acc top1 (train) 0.575
group accs (train) {0: 0.1, 1: 0.4, 2: 0.8, 3: 1.0}
Accuracy-Flow list (val): [0.5625, 0.5625, 0.54375, 0.56875]
Group accuracy (val): {0: 0.275, 1: 0.525, 2: 0.75, 3: 0.725}
Logged the results of 0.1% Pruning Rate to wandb!
/home/primmere/logs/pxp/results/4/20.0.pth
acc top1 (train) 0.6
group accs (train) {1: 0.5, 0: 0.3, 2: 0.6, 3: 1.0}
Accuracy-Flow list (val): [0.5625, 0.5625, 0.54375, 0.56875, 0.58125]
Group accuracy (val): {0: 0.25, 1: 0.7, 2: 0.725, 3: 0.65}
Logged the results of 0.2% Pruning Rate to wandb!
/home/primmere/logs/pxp/results/4/30.0.pth
acc top1 (train) 0.6
group accs (train) {2: 0.3, 3: 0.8, 0: 0.7, 1: 0.6}
Accuracy-Flow list (val): [0.5625, 0.5625, 0.54375, 0.56875, 0.58125, 0.56875]
Group accuracy (val): {0: 0.45, 1: 0.725, 2: 0.55, 3: 0.55}
Logged the results of 0.3% Pruning Rate to wandb!
/home/primmere/ide/external/pruning_by_explaining/my_experiments/my_global_pruning.py:322: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  top1_auc = np.trapz(top1_acc_list, pruning_rates)
Top1 AUC: 0.17056249999999995
Logged the AUC of the Top1 Accuracy to wandb!
Top1 AUC: 0.17056249999999995
